<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Reversing Binaries: CTF Edition | swanandx's blog</title><meta name=keywords content="RE,CTF"><meta name=description content="Methodology for reverse engineering ctf challenges"><meta name=author content="swanandx"><link rel=canonical href=https://swanandx.github.io/blog/posts/re/ctfs/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.min.2d6dbfc6e0f8a1db1c9d082a76dc11d094328cf63f247bbc2421dfaa7f2bb170.css integrity="sha256-LW2/xuD4odscnQgqdtwR0JQyjPY/JHu8JCHfqn8rsXA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blog/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://swanandx.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://swanandx.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://swanandx.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://swanandx.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://swanandx.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><meta property="og:title" content="Reversing Binaries: CTF Edition"><meta property="og:description" content="Methodology for reverse engineering ctf challenges"><meta property="og:type" content="article"><meta property="og:url" content="https://swanandx.github.io/blog/posts/re/ctfs/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-04-18T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-18T00:00:00+00:00"><meta property="og:see_also" content="https://swanandx.github.io/blog/posts/re/keygen/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Reversing Binaries: CTF Edition"><meta name=twitter:description content="Methodology for reverse engineering ctf challenges"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://swanandx.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"Reverse Engineering","item":"https://swanandx.github.io/blog/posts/re/"},{"@type":"ListItem","position":3,"name":"Reversing Binaries: CTF Edition","item":"https://swanandx.github.io/blog/posts/re/ctfs/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Reversing Binaries: CTF Edition","name":"Reversing Binaries: CTF Edition","description":"Methodology for reverse engineering ctf challenges","keywords":["RE","CTF"],"articleBody":"What is this about? I saw a lot of people struggling to solve easy reverse engineering (RE) challenges (me too when I was just starting), well, I am not saying I am great at it now, but have really improved my skills so that now I can solve many RE challenges in ctfs. That is why, I am writing this blog, hoping it will help at least a few people.\nBut what is in RE challenges? Basically, in RE challenges, you will be getting an application or executable, of which, we have to find the correct input which will lead to desired output by doing reverse engineering, end goal is to get the flag. I mostly saw the following types of executables:\n Password checker - This will take password as input, and will print flag if password is correct. Flag checker - This will take the flag as input and check if it is correct.  So I got binary in the challenge, now what? We have to basically find the flag , which can be in different formats like THM{}, ictf{}, etc. or just digits, really depending on the challenge.\nI get it, but how? Here is my simple methodology, or path, for solving it.\n You can use radare2 / gdb instead of Ghidra for static analysis too if you are familiar and comfortable with assembly.\n I will elaborate why I choose to do it like that later in the blog.\nstrings strings is very useful yet so simple command.\nAs per manual, it prints the printable characters in a file. So why it is helpful? Well, if the flag is present as printable characters, we can find it straight away. Here is example, suppose I have a binary rev_me\nI ran strings rev_me and found the password and flag :)\nHere is proof,\n.\n why start with strings ? – You will find a lot of challenges that can be solved using this single command. If you just run it and found the flag, it will save a lot of your precious time.   NOTE: strings command is also very helpful in malware analysis, check out John Hammond malware analysis videos on YouTube or MAL:strings room on TryHackMe for that.\n ltrace Now what if flag was not in strings? Next place is to trace library calls such as strcmp() if they are being used, we do it by ltrace.\nSyntax is ltrace /path/to/binary It will show the library calls being used like:\n... strcmp('idk','p@ssw0rd') ...  IMP : I did not show example as now-a-days, ltrace is not able to trace calls due to the way in which gcc compiles program. But it still can be useful in ctfs. It only takes 2 sec. to do it, so, always give it a try, we never know.\n  Now lets begin some real cool stuff. Let me first elaborate why I divided challenges in two categories in beginning.\n Password checker This binaries have work flow like:\n1. Take input - 2. check if input matches the password - 3. print flag if it matches. Our main goal is to get flag, so instead of figuring out password, we directly jump to code where it prints the flag.\nFor example, I have a binary which prints flag if password is correct. Let us use gdb\nAs you can see, I disassembled the main function. In the main function\nwe are looking for cmp here. we can see it at  . It compares 2 values and if they are equal, it jumps to . We can tell that the code at  prints the flag as it is called if compare is successful, so let’s set a breakpoint just after it takes input, i.e.  and then run it.\nwe supply it with any random password, as we are just going to skip the check anyway. Now, lets jump to  and see what happens.\nWe successfully got the flag!!\n IMP: same can be done using radare2. instead of jump, use dr rip={address to jump} and then continue it, rest procedure is similar.\n Flag checker Now what if the flag itself is the password? work flow is like\nTake flag as input - check if it is correct. Now, no use of bypassing the check, as our goal is to get the flag. So how to do it? Let us say we have binary called rev like:\nSo, in order to find flag, I used Ghidra. Open ghidra, create new project and then import the binary.\n You can learn about ghidra more from CC:Ghidra room on TryHackMe or there are many tutorials available for it.\n After analyzing binary, I checked the pseudo code generated by ghidra.\nIn main function, you can see it is xoring every character with 5 and then adding 5 to it , then it is comparing result with flag.\nLet’s check what is in flag and take note of those values.\nNow, we know what the result is, let’s find what leads to it, for that, write a script that will take character from result then subtract 5 and then xor against 5. We are doing the operations it did to our input in reverse order.\n NOTE: If you wonder why it looks so complicated, well , that is just how ghidra works. Try compiling own binaries and then reversing it to see how ghidra is generating the code.\n flag_bytes = [0x48, 0x4e, 0x49, 0x47, 0x83, 0x82, 0x3a, 0x7c, 0x5f, 0x82, 0x6f, 0x7c, 0x5f, 0x82, 0x3a, 0x7c, 0x7d] flag = \"\" for x in flag_bytes: flag += chr((x - 5)^5) print(flag) Executing the python script gives the flag!\nLet’s verify the flag  IMP : You could have solved the other challenges using ghidra, as it gives the pseudo code which is very helpful. It might be wrong sometimes though. I preferred to use Ghidra in end as it is resource heavy, but if you have resources, you can run it right away.\n What if challenge is not linux executable?  For .NET assembly use ilspy or some other .NET decompiler For .apk, There are a few steps here with different tools, but I just search for online apk decompiler on Google and use online tools. You can also decompile .exe binaries using ghidra.  Wicked cool tricks This are some tricks that I developed through practice\n If you see hex numbers getting assigned to variables in ghidra or something, always look their ASCII value. That might be the flag or password just in front of you. A lot of .java files after decompiling .apk? Suppose flag format is flag{}, just go in directory where there are all .java files and run cat *.java | grep flag{ or you can also try something like grep -iRl flag{. For first time, loops in pseudo code generated by ghidra might look complicated as there are pointers **(int)((long)local28 + 4), don’t worry about that much, just focus on our goal and understanding the flow. If there is no main function, look entry function, usually first function called there is __libc_start_main and the first argument to it is usually the main function. If binary prints like wrong, give flag or something, look at which function is responsible for it, that is most probably the main function. I suggest compile some binaries on own and look at how ghidra is generating pseudo code. This will be very helpful in understanding. You can use angr. It is a python framework for analyzing binaries. Check out videos and tutorials for it. I am sure it will worth it.  What next? TL;DR - practice!!\nWe just barely scratched surface of reverse engineering. This is just like a methodology, you need to practice a lot if you want to master it. Different ways of solving challenge, looking at assembly and pseudo code, where to look for flags and what might be rabbit hole etc.\nDo not worry if you think like you are not getting what application is doing or not able to solve challenges, it all comes with practice. There are many awesome resources and many lists of them you can find online, use them to learn more and keep practicing.\n","wordCount":"1360","inLanguage":"en","datePublished":"2021-04-18T00:00:00Z","dateModified":"2021-04-18T00:00:00Z","author":{"@type":"Person","name":"swanandx"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://swanandx.github.io/blog/posts/re/ctfs/"},"publisher":{"@type":"Organization","name":"swanandx's blog","logo":{"@type":"ImageObject","url":"https://swanandx.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://swanandx.github.io/blog/ accesskey=h title="swanandx's blog (Alt + H)">swanandx's blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://swanandx.github.io/blog/archives title=Archive><span>Archive</span></a></li><li><a href=https://swanandx.github.io/blog/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://swanandx.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://swanandx.github.io/blog/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://swanandx.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://swanandx.github.io/blog/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://swanandx.github.io/blog/posts/re/>Reverse Engineering</a></div><h1 class=post-title>Reversing Binaries: CTF Edition</h1><div class=post-description>Methodology for reverse engineering ctf challenges</div><div class=post-meta>April 18, 2021&nbsp;·&nbsp;7 min&nbsp;·&nbsp;swanandx</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#what-is-this-about aria-label="What is this about?">What is this about?</a></li><li><a href=#but-what-is-in-re-challenges aria-label="But what is in RE challenges?">But what is in RE challenges?</a></li><li><a href=#so-i-got-binary-in-the-challenge-now-what aria-label="So I got binary in the challenge, now what?">So I got binary in the challenge, now what?</a></li><li><a href=#i-get-it-but-how aria-label="I get it, but how?">I get it, but how?</a><ul><li><a href=#strings aria-label=strings>strings</a></li><li><a href=#ltrace aria-label=ltrace>ltrace</a></li><li><a href=#password-checker aria-label="Password checker">Password checker</a></li><li><a href=#flag-checker aria-label="Flag checker">Flag checker</a></li><li><a href=#what-if-challenge-is-not-linux-executable aria-label="What if challenge is not linux executable?">What if challenge is not linux executable?</a></li></ul></li><li><a href=#wicked-cool-tricks aria-label="Wicked cool tricks">Wicked cool tricks</a></li><li><a href=#what-next aria-label="What next?">What next?</a></li></ul></div></details></div><div class=post-content><h1 id=what-is-this-about>What is this about?<a hidden class=anchor aria-hidden=true href=#what-is-this-about>#</a></h1><p>I saw a lot of people struggling to solve easy reverse engineering (RE) challenges (me too when I was just starting), well, I am not saying I am great at it now, but have really improved my skills so that now I can solve many RE challenges in ctfs. That is why, I am writing this blog, hoping it will help at least a few people.</p><h1 id=but-what-is-in-re-challenges>But what is in RE challenges?<a hidden class=anchor aria-hidden=true href=#but-what-is-in-re-challenges>#</a></h1><p>Basically, in RE challenges, you will be getting an application or executable, of which, we have to find the correct input which will lead to desired output by doing reverse engineering, end goal is to get the flag. I mostly saw the following types of executables:</p><ul><li><strong>Password checker</strong> - This will take password as input, and will print flag if password is correct.</li><li><strong>Flag checker</strong> - This will take the flag as input and check if it is correct.</li></ul><h1 id=so-i-got-binary-in-the-challenge-now-what>So I got binary in the challenge, now what?<a hidden class=anchor aria-hidden=true href=#so-i-got-binary-in-the-challenge-now-what>#</a></h1><p>We have to basically find the <em>flag</em> , which can be in different formats like THM{}, ictf{}, etc. or just digits, really depending on the challenge.</p><h1 id=i-get-it-but-how>I get it, but how?<a hidden class=anchor aria-hidden=true href=#i-get-it-but-how>#</a></h1><p>Here is my simple methodology, or path, for solving it.</p><p><img loading=lazy src=./images/path.png#center alt=path></p><blockquote><p>You can use radare2 / gdb instead of Ghidra for static analysis too if you are familiar and comfortable with assembly.</p></blockquote><p>I will elaborate why I choose to do it like that later in the blog.</p><h2 id=strings>strings<a hidden class=anchor aria-hidden=true href=#strings>#</a></h2><p><code>strings</code> is very useful yet so simple command.</p><p><img loading=lazy src=./images/005bd2b6f25443479718e8af4f83718e.png#center alt=0a6a3b10bb3aec43d5b9beb96e80b044.png></p><p>As per manual, it prints the printable characters in a file. So why it is helpful?
Well, if the flag is present as printable characters, we can find it straight away.
Here is example, suppose I have a binary <code>rev_me</code></p><p><img loading=lazy src=./images/3490a905f88048eaa4e935800b8e418d.png#center alt=a75a930bff416e16dab39a06e9a5d502.png></p><p>I ran <code>strings rev_me</code> and found the password and flag :)</p><p><img loading=lazy src=./images/fd929c91cbd44b1fb1426ac913723769.png#center alt=b39d978974ce39958bd39613eda91592.png></p><p>Here is proof,</p><p><img loading=lazy src=./images/968170f05c7647389dba1c0c7ab43d05.png#center alt=5df05378c7e2e7795ac90e7c10dd6af2.png>
.</p><ul><li>why start with <code>strings</code> ? &ndash;> You will find a lot of challenges that can be solved using this single command. If you just run it and found the flag, it will save a lot of your precious time.</li></ul><blockquote><p><strong>NOTE</strong>: <code>strings</code> command is also very helpful in malware analysis, check out <a href=https://www.youtube.com/c/JohnHammond010/videos>John Hammond</a> malware analysis videos on YouTube or <a href=https://tryhackme.com/room/malstrings>MAL:strings</a> room on TryHackMe for that.</p></blockquote><h2 id=ltrace>ltrace<a hidden class=anchor aria-hidden=true href=#ltrace>#</a></h2><p>Now what if flag was not in strings? Next place is to trace library calls such as <code>strcmp()</code> if they are being used, we do it by <code>ltrace</code>.</p><p><img loading=lazy src=./images/69acf362f0e94ed085452ea973f3198e.png#center alt=d103acfbe36cf136388425dd84aa61f9.png></p><p>Syntax is <code>ltrace /path/to/binary</code>
It will show the library calls being used like:</p><pre><code>...
strcmp('idk','p@ssw0rd')
...
</code></pre><blockquote><p><strong>IMP</strong> : I did not show example as now-a-days, <code>ltrace</code> is not able to trace calls due to the way in which gcc compiles program. But it still can be useful in ctfs.
It only takes 2 sec. to do it, so, always give it a try, we never know.</p></blockquote><hr><p>Now lets begin some real cool stuff. Let me first elaborate why I divided challenges in two categories in beginning.</p><hr><h2 id=password-checker>Password checker<a hidden class=anchor aria-hidden=true href=#password-checker>#</a></h2><p>This binaries have work flow like:</p><pre><code>1. Take input -&gt; 2. check if input matches the password -&gt; 3. print flag if it matches.
</code></pre><p>Our main goal is to get flag, so instead of figuring out password, we directly jump to code where it prints the flag.</p><p>For example, I have a binary which prints flag if password is correct.
Let us use <code>gdb</code></p><p><img loading=lazy src=./images/b241c1e579924d59aca5046d18b50c90.png#center alt=52bc4fb12d3beebd382466f34d77be32.png></p><p>As you can see, I disassembled the main function. In the main function</p><p><img loading=lazy src=./images/fef434cc8c7d46eea01600ed0499df9c.png#center alt=cac26373a57c04f6f29094bc18bb2a9d.png></p><p>we are looking for <code>cmp</code> here. we can see it at <code>&lt;+103></code> . It compares 2 values and if they are equal, it jumps to <code>&lt;main+129></code>. We can tell that the code at <code>&lt;main+129></code> prints the flag as it is called if compare is successful, so let&rsquo;s set a breakpoint just after it takes input, i.e. <code>&lt;main+68></code> and then run it.</p><p><img loading=lazy src=./images/508fc5d2f0024fce83566c9329e09d63.png#center alt=208f810cfb5561dfea4cbf156dbfb3d6.png></p><p>we supply it with any random password, as we are just going to skip the check anyway.
Now, lets jump to <code>&lt;main+129></code> and see what happens.</p><p><img loading=lazy src=./images/156dc22fb8c540ffb60ebfa64337a5e4.png#center alt=c2ae8affab305a8a3f67c6b7f2055814.png></p><p>We successfully got the flag!!</p><blockquote><p><strong>IMP</strong>: same can be done using radare2. instead of <code>jump</code>, use <code>dr rip={address to jump}</code> and then continue it, rest procedure is similar.</p></blockquote><h2 id=flag-checker>Flag checker<a hidden class=anchor aria-hidden=true href=#flag-checker>#</a></h2><p>Now what if the flag itself is the password? work flow is like</p><pre><code>Take flag as input -&gt; check if it is correct.
</code></pre><p>Now, no use of bypassing the check, as our goal is to get the flag. So how to do it?
Let us say we have binary called <code>rev</code> like:</p><p><img loading=lazy src=./images/d6536584c29e4894917528d710859213.png#center alt=9781fa4d82a217e25625c5d7879068af.png></p><p>So, in order to find flag, I used Ghidra. Open ghidra, create new project and then import the binary.</p><blockquote><p>You can learn about ghidra more from <a href=https://tryhackme.com/room/ccghidra>CC:Ghidra</a> room on TryHackMe or there are many tutorials available for it.</p></blockquote><p>After analyzing binary, I checked the <em>pseudo code</em> generated by ghidra.</p><p>In <code>main</code> function, you can see it is xoring every character with <code>5</code> and then adding <code>5</code> to it , then it is comparing result with <code>flag</code>.</p><p><img loading=lazy src=./images/09370b9f8848484dba3ead4cafe53634.png#center alt=main.png></p><p>Let&rsquo;s check what is in <code>flag</code> and take note of those values.</p><p><img loading=lazy src=./images/224739b99dd74f37a2a7a2555005a17f.png#center alt=flag.png></p><p>Now, we know what the result is, let&rsquo;s find what leads to it, for that, write a script that will take character from result then subtract <code>5</code> and then xor against <code>5</code>. We are doing the operations it did to our input in reverse order.</p><blockquote><p>NOTE: If you wonder why it looks so complicated, well , that is just how ghidra works. Try compiling own binaries and then reversing it to see how ghidra is generating the code.</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>flag_bytes <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x4e</span>, <span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0x83</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0x3a</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0x5f</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0x6f</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0x5f</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0x3a</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0x7d</span>]

flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
<span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> flag_bytes:
	flag <span style=color:#f92672>+=</span> chr((x <span style=color:#f92672>-</span> <span style=color:#ae81ff>5</span>)<span style=color:#f92672>^</span><span style=color:#ae81ff>5</span>)

<span style=color:#66d9ef>print</span>(flag)
</code></pre></div><p>Executing the python script gives the flag!</p><p><img loading=lazy src=./images/565b5989acb144beb1a02bcc1ec98ca9.png#center alt=Screenshot_2021-04-17_10-42-55.png></p><p>Let&rsquo;s verify the flag
<img loading=lazy src=./images/3d6cd59f934f43b8baa4d6eab8dabf88.png#center alt=93c9847c8ff54c6d9a4c481b61d2861d.png></p><blockquote><p><strong>IMP :</strong> You could have solved the other challenges using ghidra, as it gives the <em>pseudo code</em> which is very helpful. It might be wrong sometimes though.
I preferred to use Ghidra in end as it is resource heavy, but if you have resources, you can run it right away.</p></blockquote><h2 id=what-if-challenge-is-not-linux-executable>What if challenge is not linux executable?<a hidden class=anchor aria-hidden=true href=#what-if-challenge-is-not-linux-executable>#</a></h2><ul><li>For <code>.NET assembly</code> use <code>ilspy</code> or some other <code>.NET decompiler</code></li><li>For <code>.apk</code>, There are a few steps here with different tools, but I just search for <code>online apk decompiler</code> on Google and use online tools.</li><li>You can also decompile <code>.exe</code> binaries using ghidra.</li></ul><h1 id=wicked-cool-tricks>Wicked cool tricks<a hidden class=anchor aria-hidden=true href=#wicked-cool-tricks>#</a></h1><p>This are some tricks that I developed through practice</p><ul><li>If you see hex numbers getting assigned to variables in ghidra or something, always look their ASCII value. That might be the flag or password just in front of you.</li><li>A lot of <code>.java</code> files after decompiling <code>.apk</code>? Suppose flag format is <code>flag{}</code>, just go in directory where there are all <code>.java</code> files and run <code>cat *.java | grep flag{</code> or you can also try something like <code>grep -iRl flag{</code>.</li><li>For first time, loops in pseudo code generated by ghidra might look complicated as there are pointers <code>**(int)((long)local28 + 4)</code>, don&rsquo;t worry about that much, just focus on our goal and understanding the flow.</li><li>If there is no <code>main</code> function, look <code>entry</code> function, usually first function called there is <code>__libc_start_main</code> and the first argument to it is usually the <code>main</code> function.</li><li>If binary prints like <code>wrong</code>, <code>give flag</code> or something, look at which function is responsible for it, that is most probably the <code>main</code> function.
I suggest compile some binaries on own and look at how ghidra is generating pseudo code. This will be very helpful in understanding.</li><li>You can use <code>angr</code>. It is a python framework for analyzing binaries. Check out videos and tutorials for it. I am sure it will worth it.</li></ul><h1 id=what-next>What next?<a hidden class=anchor aria-hidden=true href=#what-next>#</a></h1><p>TL;DR - <strong>practice!!</strong></p><p>We just barely scratched surface of reverse engineering. This is just like a methodology, you need to practice a lot if you want to master it. Different ways of solving challenge, looking at assembly and pseudo code, where to look for flags and what might be rabbit hole etc.</p><p>Do not worry if you think like you are not getting what application is doing or not able to solve challenges, it all comes with practice.
There are many awesome resources and many lists of them you can find online, use them to learn more and keep practicing.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://swanandx.github.io/blog/tags/re/>RE</a></li><li><a href=https://swanandx.github.io/blog/tags/ctf/>CTF</a></li></ul><nav class=paginav><a class=prev href=https://swanandx.github.io/blog/posts/re/keygen/><span class=title>« Prev Page</span><br><span>Reversing Binaries: Key generators</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Reversing Binaries: CTF Edition on twitter" href="https://twitter.com/intent/tweet/?text=Reversing%20Binaries%3a%20CTF%20Edition&url=https%3a%2f%2fswanandx.github.io%2fblog%2fposts%2fre%2fctfs%2f&hashtags=RE%2cCTF"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing Binaries: CTF Edition on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fswanandx.github.io%2fblog%2fposts%2fre%2fctfs%2f&title=Reversing%20Binaries%3a%20CTF%20Edition&summary=Reversing%20Binaries%3a%20CTF%20Edition&source=https%3a%2f%2fswanandx.github.io%2fblog%2fposts%2fre%2fctfs%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing Binaries: CTF Edition on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fswanandx.github.io%2fblog%2fposts%2fre%2fctfs%2f&title=Reversing%20Binaries%3a%20CTF%20Edition"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing Binaries: CTF Edition on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fswanandx.github.io%2fblog%2fposts%2fre%2fctfs%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing Binaries: CTF Edition on whatsapp" href="https://api.whatsapp.com/send?text=Reversing%20Binaries%3a%20CTF%20Edition%20-%20https%3a%2f%2fswanandx.github.io%2fblog%2fposts%2fre%2fctfs%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reversing Binaries: CTF Edition on telegram" href="https://telegram.me/share/url?text=Reversing%20Binaries%3a%20CTF%20Edition&url=https%3a%2f%2fswanandx.github.io%2fblog%2fposts%2fre%2fctfs%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://swanandx.github.io/blog/>swanandx's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>